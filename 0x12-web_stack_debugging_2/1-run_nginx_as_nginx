#!/usr/bin/env bash
# fix container:: task 2

# Stop any running Apache2 service if necessary
pkill -f apache2

# Ensure the Nginx configuration file permissions are correct
sudo chmod 644 /etc/nginx/nginx.conf

# Ensure Nginx is set to run as the 'nginx' user
sudo sed -i 's/^user\s.*/user nginx;/' /etc/nginx/nginx.conf

# Update the listening port to 8080 in the default site configuration
sudo sed -i 's/listen 80 default_server;/listen 8080 default_server;/' /etc/nginx/sites-enabled/default
sudo sed -i 's/listen \[::\]:80 default_server;/listen \[::\]:8080 default_server;/' /etc/nginx/sites-enabled/default

# Restart Nginx to apply changes
sudo systemctl restart nginx
